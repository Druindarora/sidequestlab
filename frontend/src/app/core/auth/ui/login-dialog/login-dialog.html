<h2 mat-dialog-title>Se connecter</h2>

<form class="login-dialog__form" [formGroup]="form" (ngSubmit)="submit($event)">
  <div mat-dialog-content>
    <mat-form-field appearance="outline" class="login-dialog__field">
      <mat-label>Email</mat-label>
      <input matInput type="email" formControlName="email" autocomplete="username" />
      @if (form.controls.email.touched && form.controls.email.hasError('required')) {
        <mat-error>L'email est requis.</mat-error>
      }
      @if (form.controls.email.touched && form.controls.email.hasError('email')) {
        <mat-error>Format d'email invalide.</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="login-dialog__field">
      <mat-label>Mot de passe</mat-label>
      <input matInput type="password" formControlName="password" autocomplete="current-password" />
      @if (form.controls.password.touched && form.controls.password.hasError('required')) {
        <mat-error>Le mot de passe est requis.</mat-error>
      }
    </mat-form-field>

    @if (errorMessage) {
      <p class="login-dialog__error">{{ errorMessage }}</p>
    }
  </div>

  <div mat-dialog-actions align="end">
    <button mat-button type="button" (click)="close()" [disabled]="loading">Annuler</button>
    <button mat-flat-button color="primary" type="submit" [disabled]="loading || form.invalid">
      {{ loading ? 'Connexion...' : 'Se connecter' }}
    </button>
  </div>
</form>
